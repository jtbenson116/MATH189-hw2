---
title: "Math189_Homework02"
output: html_document
---

# TO-DO: Change all var names with - to .

```{r}
# Read in the csv file 
video_df <- read.csv('data/video_fixed.csv')
# removes the last row (all NA values)
video_df <- video_df[-nrow(video_df),]
video_df
```
```{r}
# Clean video multiple df
#read in csv file
video_multiple_df <- read.csv('data/video_multiple_fixed.csv')
#sets first row as col names
colnames(video_multiple_df) <- video_multiple_df[1,]
#removes the first row
video_multiple_df <- video_multiple_df[-1, ] 
video_multiple_df
```

```{r}
# Clean video_df
video_df$like[video_df$like==99] <- NA
video_df$where[video_df$where==99] <- NA
video_df$freq[video_df$freq==99] <- NA
video_df$busy[video_df$busy==99] <- NA
video_df$educ[video_df$educ==99] <- NA
video_df$math[video_df$math==99] <- NA
video_df$work[video_df$work==99] <- NA
video_df$cdrom[video_df$cdrom==99] <- NA
```

```{r}
#SCENARIO 1
played.videogames <- video_df$time
played.videogames[played.videogames > 0] <- 1
played.videogames

# t.test(played_videogames)

#BOOTSTRAPPING
n <- 91
N = 314
ind.boot <- sample.int(n, size=N, replace=TRUE)
boot.played.videogames <- played.videogames[ind.boot]
B <- 2000
boot.played.videogames.mean <- rep(NA, B)
for(i in 1:B) {
        ind <- sample.int(N, size=n, replace=TRUE)
        boot <- boot.played.videogames[ind]
        boot.played.videogames.mean[i] <- mean(boot)
}

# Fraction of kids that played video games the week before the test
sample.mean <- mean(played.videogames)
sample.mean

# Estimate of fraction of kids that played vgs before the test using bootstrap
bootstrap.mean <- mean(boot.played.videogames.mean)
bootstrap.mean

# Confidence Interval (Bootstrap Sample Means)
boot.played.videogames.sd <- sd(boot.played.videogames.mean)
boot.played.videogames.sd

boot.played.videogames.ci <- c(bootstrap.mean - 1.96*boot.played.videogames.sd, bootstrap.mean + + 1.96*boot.played.videogames.sd)
# Confidence Interval = 95% (Where z = 1.96)
boot.played.videogames.ci

# 0.025-quantile and 0.975 quantile of the bootstrap sample means (Interval Estimate)
boot.played.videogames.qqi <- c(quantile(bootstrap.mean, 0.025), quantile(bootstrap.mean, 0.975))
boot.played.videogames.qqi


# Histrogram and QQ Plot Generations
hist(boot.played.videogames.mean, main="Played Video Games Mean Bootstrap Histogram", xlab="Bootstrap Sample Mean")
dev.copy(png,'graphs/scen1histogram.png')
dev.off()
qqnorm(boot.played.videogames.mean, main="Played Video Games Mean Bootstrap QQ Plot")
qqline(boot.played.videogames.mean)
dev.copy(png,'graphs/scen1qqline.png')
dev.off()
```

```{r}
#SCENARIO 2
#video_df$freq[video_df$freq==99] <- NA
video_df

plot(video_df$time, video_df$freq, main="Time Played and Frequency Played Video Games Scatterplot", 
        xlab="Amount of Hours Played Video Games Last Week", ylab="Frequency Play Video Games", yaxt="n")
axis(2, at=1:4, labels=list("Daily", "Weekly", "Monthly", "Semesterly"))
dev.copy(png,'graphs/scen2scatter.png')
dev.off()
cor(video_df$time, video_df$freq, use = "complete.obs")
## Too low to mean anything
## result of bias to the data as asked about playing video games the week before a midterm. 

```

```{r}
#SCENARIO 6
#split into not played (5 and 1)
not_liked = video_df[video_df$like == 1 | video_df$like == 5,]
#split into played (2, 3, 4)
liked = video_df[video_df$like==2|video_df$like==2|video_df$like==3,]
barplot(table(not_liked$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Not Liked', border=TRUE,
        xlab='Grade Expected', ylab='count')
barplot(table(liked$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Liked', border=TRUE,
        xlab='Grade Expected', ylab='count')

```

```{r}
educ1 = video_df[video_df$educ==1,]
educ0 = video_df[video_df$educ==0,]
   
barplot(table(educ0$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Not Educational', border=TRUE,
        xlab='Grade Expected', ylab='count')
barplot(table(educ1$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Educational', border=TRUE,
        xlab='Grade Expected', ylab='count')

```
