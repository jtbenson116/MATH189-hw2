---
title: "Math189_Homework02"
output: html_document
---
```{r}
# Read in the csv file 
video_df <- read.csv('data/video_fixed.csv')
# removes the last row (all NA values)
video_df <- video_df[-nrow(video_df),]
video_df
```
```{r}
# Clean video multiple df
#read in csv file
video_multiple_df <- read.csv('data/video_multiple_fixed.csv')
#sets first row as col names
colnames(video_multiple_df) <- video_multiple_df[1,]
#removes the first row
video_multiple_df <- video_multiple_df[-1, ] 
video_multiple_df
```


```{r}
# Clean video_df
video_df$like[video_df$like==99] <- NA
video_df$where[video_df$where==99] <- NA
video_df$freq[video_df$freq==99] <- NA
video_df$busy[video_df$busy==99] <- NA
video_df$educ[video_df$educ==99] <- NA
video_df$math[video_df$math==99] <- NA
video_df$work[video_df$work==99] <- NA
video_df$cdrom[video_df$cdrom==99] <- NA
```

```{r}
#SCENARIO 1
played_videogames <- video_df$time
played_videogames[played_videogames > 0] <- 1
played_videogames

t.test(played_videogames)

```
```{r}
#SCENARIO 3
#point estimate for mean of time 
mean.time <- mean(video_df$time)
mean.time
#constructing confidence interval for mean of time, continuous variable 
width <- 1.96 *sd(video_df$time)* sqrt((314-91)/((91)*314))
int.time <- c(mean.time - width, mean.time + width)
int.time
#Distribution of time
hist(video_df$time)
qqnorm(video_df$time)
qqline(video_df$time)
#constructing bootstrap estimate
#creating bootstrap population
ind.boot <- sample.int(91, size=314, replace=TRUE)
time.boot <- video_df$time[ind.boot]
#generating bootstrap sample means
B <- 2000
boot.sample.mean <- rep(NA, B)
for(i in 1:B){
  ind <- sample.int(314, size=91, replace=FALSE)
  boot <- time.boot[ind]
  boot.sample.mean[i] <- mean(boot)
}
#Distribution of bootstrap sample means 
hist(boot.sample.mean)
qqnorm(boot.sample.mean)
qqline(boot.sample.mean)
#constructing confidence interval using bootstrap means
time.mean.boot <- mean(boot.sample.mean)
time.int.boot <- c(time.mean.boot - 1.96*sd(boot.sample.mean), time.mean.boot + 1.96*sd(boot.sample.mean))
time.int.boot
```

```{r}
#SCENARIO 4
#creates table for like varible
likeAlone <- table(video_df$like)
#Below adds instances where like = 1 or 5
noGames <- as.double(likeAlone[1]+likeAlone[5])
#portion of surveyees who never played/don't like playing video games at all
noGames/nrow(video_df)
#instances of "relax" reason for playing video games
relax <- as.double(table(video_multiple_df$relax[video_multiple_df$relax==1]))
#instances of "grahics" reason for playing video games
graphics <- as.double(table(video_multiple_df$graphic[video_multiple_df$graphic==1]))
#instances of "master" reason for playing video games
master <- as.double(table(video_multiple_df$master[video_multiple_df$master==1]))
#instances of "bored" reason for playing video games
bored <- as.double(table(video_multiple_df$bored[video_multiple_df$bored==1]))
#instances of "challenge" reason for playing video games
challenge <- as.double(table(video_multiple_df$challenge[video_multiple_df$challenge==1]))
#instances of "coordination" reason for playing video games
coord <- as.double(table(video_multiple_df$coord[video_multiple_df$coord==1]))
#creates vector of each reason instance
reasons <- c(relax,graphics,master,bored,challenge,coord)
#attaches reason name to each instance sum
names(reasons) <- c("relax","graphics","master","bored","challenge","coord")
#sorted display of the reasons and summed instances
sort(reasons, decreasing = TRUE)

#Below we see find the most prominent reasons why students don't like vdgm.'s
#instances of "time" reason for not playing video games
time <- as.double(table(video_multiple_df$time[video_multiple_df$time==1]))
#instances of "frust" reason for playing video games
frust <- as.double(table(video_multiple_df$frust[video_multiple_df$frust==1]))
#instances of "lonely" reason for playing video games
lonely <- as.double(table(video_multiple_df$lonely[video_multiple_df$lonely==1]))
#instances of "rules" reason for playing video games
rules <- as.double(table(video_multiple_df$rules[video_multiple_df$rules==1]))
#instances of "cost" reason for playing video games
cost <- as.double(table(video_multiple_df$cost[video_multiple_df$cost==1]))
#instances of "boring" reason for playing video games
boring <- as.double(table(video_multiple_df$boring[video_multiple_df$boring==1]))
#instances of "friends don't play" reason for playing video games
friends <- as.double(table(video_multiple_df$friends[video_multiple_df$friends==1]))
#instances of "pointless" reason for playing video games
pointless <- as.double(table(video_multiple_df$point[video_multiple_df$point==1]))

#creates vector of each dislike reason instance
dislikeReasons <- c(time,frust,lonely,rules,cost,boring, friends,pointless)
#attaches reason name to each instance sum
names(dislikeReasons) <- c("time","frust","lonely","rules","cost","boring","friends","pointless")
#sorted display of the reasons and summed instances
sort(dislikeReasons, decreasing = TRUE)
```

```{r}
#SCENARIO 6
#split into not played (5 and 1)
not_liked = video_df[video_df$like == 1 | video_df$like == 5,]
#split into played (2, 3, 4)
liked = video_df[video_df$like==2|video_df$like==2|video_df$like==3,]
barplot(table(not_liked$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Not Liked', border=TRUE,
        xlab='Grade Expected', ylab='count')
barplot(table(liked$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Liked', border=TRUE,
        xlab='Grade Expected', ylab='count')

```

```{r}
educ1 = video_df[video_df$educ==1,]
educ0 = video_df[video_df$educ==0,]
   
barplot(table(educ0$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Not Educational', border=TRUE,
        xlab='Grade Expected', ylab='count')
barplot(table(educ1$grade),names.arg=c('C','B','A'),col = c('red','blue','green') ,main= 'Distribution of Grades - Educational', border=TRUE,
        xlab='Grade Expected', ylab='count')

```
